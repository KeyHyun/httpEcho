<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <property name="LOGS_ABSOLUTE_PATH" value="./logs"/>

  <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
    <encoder>
      <pattern>[%d{yyyy-MM-dd HH:mm:ss.SSS}] [%X{transKey}] [%-5level] [%logger{36}] - %msg%n</pattern>
    </encoder>
  </appender>

  <appender name="ROLLING" class="ch.qos.logback.core.rolling.RollingFileAppender">
    <file>${LOGS_ABSOLUTE_PATH}/application.log</file>
    <encoder>
      <pattern>[%d{yyyy-MM-dd HH:mm:ss.SSS}:%-3relative][%thread] [%X{transKey}] %-5level %logger{35} - %msg%n
      </pattern>
    </encoder>
    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
      <fileNamePattern>${LOGS_ABSOLUTE_PATH}/application.%d{yyyy-MM-dd}.%i.log</fileNamePattern>
      <timeBasedFileNamingAndTriggeringPolicy
        class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
        <!-- or whenever the file size reaches 100MB -->
        <maxFileSize>256MB</maxFileSize>
      </timeBasedFileNamingAndTriggeringPolicy>
    </rollingPolicy>
  </appender>

  <appender name="ERRORROLLING" class="ch.qos.logback.core.rolling.RollingFileAppender">
    <File>${LOGS_ABSOLUTE_PATH}/error.log</File>
    <encoder>
      <Pattern>[%d{yyyy-MM-dd HH:mm:ss.SSS}:%-3relative][%thread] [%X{transKey}] %-5level %logger{35} - %msg%n
      </Pattern>
    </encoder>
    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
      <!-- daily rollover -->
      <FileNamePattern>${LOGS_ABSOLUTE_PATH}/error.%d{yyyy-MM-dd}.%i.log</FileNamePattern>
      <timeBasedFileNamingAndTriggeringPolicy
        class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
        <!-- or whenever the file size reaches 100MB -->
        <maxFileSize>256MB</maxFileSize>
      </timeBasedFileNamingAndTriggeringPolicy>
    </rollingPolicy>
    <filter class="ch.qos.logback.classic.filter.LevelFilter">
      <level>error</level>
      <onMatch>ACCEPT</onMatch>
      <onMismatch>DENY</onMismatch>
    </filter>
  </appender>

  <appender name="VANTRANSLOG" class="ch.qos.logback.core.rolling.RollingFileAppender">
    <filter class="ch.qos.logback.core.filter.EvaluatorFilter">
      <evaluator class="ch.qos.logback.classic.boolex.OnMarkerEvaluator">
        <marker>VTRANS</marker>
      </evaluator>
      <OnMatch>ACCEPT</OnMatch>
      <OnMismatch>DENY</OnMismatch>
    </filter>
    <file>${LOGS_ABSOLUTE_PATH}/vantrans.log</file>
    <append>true</append>
    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
      <fileNamePattern>${LOGS_ABSOLUTE_PATH}/vantrans.%d{yyyyMMdd}.%i.log</fileNamePattern>
      <timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
        <!-- or whenever the file size reaches 50MB -->
        <maxFileSize>100MB</maxFileSize>
      </timeBasedFileNamingAndTriggeringPolicy>
      <maxHistory>20</maxHistory>
    </rollingPolicy>
    <encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
      <pattern>%d{HH:mm:ss.SSS} [%X{transKey}] %-6level %logger{35}[%thread]::%msg%n</pattern>
    </encoder>
  </appender>

  <appender name="TRANSLOG" class="ch.qos.logback.core.rolling.RollingFileAppender">
    <filter class="ch.qos.logback.core.filter.EvaluatorFilter">
      <evaluator class="ch.qos.logback.classic.boolex.OnMarkerEvaluator">
        <marker>TRANS</marker>
      </evaluator>
      <OnMatch>ACCEPT</OnMatch>
      <OnMismatch>DENY</OnMismatch>
    </filter>
    <file>${LOGS_ABSOLUTE_PATH}/trans.log</file>
    <append>true</append>
    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
      <fileNamePattern>${LOGS_ABSOLUTE_PATH}/trans.%d{yyyyMMdd}.%i.log</fileNamePattern>
      <timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
        <!-- or whenever the file size reaches 50MB -->
        <maxFileSize>100MB</maxFileSize>
      </timeBasedFileNamingAndTriggeringPolicy>
      <maxHistory>20</maxHistory>
    </rollingPolicy>
    <encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
      <pattern>%d{HH:mm:ss.SSS} [%X{transKey}] %-6level %logger{35}[%thread]::%msg%n</pattern>
    </encoder>
  </appender>

  <appender name="MEMORYLOG" class="ch.qos.logback.core.rolling.RollingFileAppender">
    <filter class="ch.qos.logback.core.filter.EvaluatorFilter">
      <evaluator class="ch.qos.logback.classic.boolex.OnMarkerEvaluator">
        <marker>MEMCHECK</marker>
      </evaluator>
      <OnMatch>ACCEPT</OnMatch>
      <OnMismatch>DENY</OnMismatch>
    </filter>
    <file>${LOGS_ABSOLUTE_PATH}/memory_check.log</file>
    <append>true</append>
    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
      <fileNamePattern>${LOGS_ABSOLUTE_PATH}/memory_check.%d{yyyyMMdd}.%i.log</fileNamePattern>
      <timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
        <!-- or whenever the file size reaches 50MB -->
        <maxFileSize>100MB</maxFileSize>
      </timeBasedFileNamingAndTriggeringPolicy>
      <maxHistory>20</maxHistory>
    </rollingPolicy>
    <encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
      <pattern>%d{HH:mm:ss.SSS} [%X{transKey}] %-6level %logger{35}[%thread]::%msg%n</pattern>
    </encoder>
  </appender>

  <!-- log4jdbc 옵션 설정 -->
  <logger name="log4jdbc" level="INFO"/>
<!--  &lt;!&ndash; sql문만 로깅할지 여부 &ndash;&gt;-->
<!--  <logger name="jdbc.sqlonly" level="WARN"/>-->
<!--  &lt;!&ndash; 쿼리문 수행시간 로깅 여부 &ndash;&gt;-->
<!--  <logger name="jdbc.sqltiming" level="WARN"/>-->
<!--  &lt;!&ndash; ResultSet외 모든 JDBC 호출 정보 로깅할지 여부 &ndash;&gt;-->
<!--  <logger name="jdbc.audit" level="WARN"/>-->
<!--  &lt;!&ndash; ResultSet 포함 모든 JDBC 호출 정보를 로깅 &ndash;&gt;-->
<!--  <logger name="jdbc.resultset" level="WARN"/>-->
<!--  <logger name="jdbc.resultsettable" level="WARN"/>-->
<!--  &lt;!&ndash; connection open close 로깅 여부 &ndash;&gt;-->
<!--  <logger name="jdbc.connection" level="WARN"/>-->

  <root level="INFO">
    <appender-ref ref="STDOUT"/>
    <appender-ref ref="ROLLING"/>
    <appender-ref ref="ERRORROLLING"/>
    <appender-ref ref="TRANSLOG"/>
    <appender-ref ref="VANTRANSLOG"/>
    <appender-ref ref="MEMORYLOG"/>
  </root>

</configuration>
